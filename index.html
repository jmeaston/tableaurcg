<html><head>

	<script>
		// Set any JS variables that require context from the Django app here.
		// They will flow down to any other included scripts
                var tableauServerBaseUrl = "https://ts2.embedded.tableau.com";
		var translatedSSOErrorMsg = 'An error occurred with SSO to Tableau Server. \nPlease reload the page, and if error reoccurs, notify an administrator.';
	</script>

	<!-- Load the shared UI helper JS for this theme -->
	<script type="text/javascript" src="/staticfiles/js/dark_theme_ui.js"></script>
	<script>
		// Set to true to get everything happening logged to the console
		debugflag = false;
	</script>


<!-- Contains the functions to ping Tableau for trusted auth -->
	<script type="text/javascript" src="/staticfiles/js/auth_helpers.js"></script>
	<script>
		// Obfuscate endpoint name in real life
		var tktEndpoint = "/nrwl";
		var siteContentUrl = 'retail';
		var loginWorkbook = 'RedirectPage';
		var loginView = 'Sheet1';
		// Initial login and showing a viz is down in a lower code block, so it can be overwritten

		// This one to run on the timeout extension
		function extendAuthSession(){
			authThenLoad(tableauServerBaseUrl, siteContentUrl, loginWorkbook, loginView, function () {}, alertUserSSOFailed);
		};

		// Set a timeout to run this again after specified time
		setInterval(extendAuthSession, pingMilliseconds);

	</script>



	<title>Interactive Analytics</title>


	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
<!--
These reference the specific assets within the static directories
-->
	<link rel="stylesheet" href="/staticfiles/solidstate/assets/css/main.css">
	<link rel="stylesheet" href="/staticfiles/solidstate/assets/css/embedded_system.css">
	<link rel="shortcut icon" type="image/png" href="/staticfiles/favicon.ico">
	<noscript><link rel="stylesheet" href="/staticfiles/solidstate/assets/css/noscript.css" /></noscript>

	<style>

	/* CSS rules that haven't been incorporated into the embedded_system.css yet. Good for testing.
	Or any rules that need to be affected by the template (such as the background of the banner */

	
		/* CSS requiring Django template context -- must remain in this file */
		#banner {
			padding: 2em 0 2em 0;
			background-color: #2e3141;
			background-image: linear-gradient(to top, rgba(46, 49, 65, 0.8), rgba(46, 49, 65, 0.8)), url("/media/images/ammiel-jr-447538-unsplash.jpg");
			background-size: auto, cover;
			background-position: center, center;
		}

		/* End of CSS requiring template context */

		/* WIP CSS which should eventually be moved to assets/css/embedded_system.css */
		#toolbar-flex-wrapper {
			padding: 10px 10px 10px 0;
			display: flex;
			justify-content: flex-start;
			flex-wrap: wrap;
			position: fixed;
			top: 0px;
			left: 0px;
			background-color: rgb(40, 40, 50);
			width: 100%;
			height: 70px;
			z-index: 100;
			border-bottom: 2px solid rgba(256, 256, 256, 0.125);
		}

		#page-title-div {
			margin-left: 4em;
			padding-top: 5px;
		}

		#rightEdgeContainer {
			margin-right: 10px;
		}

		#rightEdgeContainer div {
			margin: 5px 0px 0 15px;
		}

		@media screen and (max-width: 1080px) {
		  div#title-div {
			display: none;
			transition: display 1s, transform 1s;
		  }

		  div#page-title-div {
			margin-left: 0px;
			padding-left: 0px;
		  }

		  div#showMenuDiv {
		  	display: block!important;
		  }

		  #sidebar-visible {
		  	display: none;
		  }

		  #outer-main-div {
		  	padding-left: 2em!important;
		  }

		  #sidebar-visible {
		  	width: 100%!important;
		  	margin-left: auto;
		  	margin-right: auto;
		  }

		  #rightEdgeContainer div {
			margin: 5px 0px 0 10px;
		  }


		}

		@media screen and (min-width: 1081px) {
			  #sidebar-visible {
				display: block!important;
			  }
		}


		/* End WIP CSS */

	

	
		/* Any additional CSS rules can be added here. Most likely in another template that extends this one */
	

	</style>
<style type="text/css">a#link-to-fond:hover{background-color:#fff;color:#4e80ff!important}a#link-to-fond:visited{color:#fff}#close-fond-bar:hover{cursor:pointer}#fond-bar{display:block;height:50px;max-height:60px;min-height:10px;background-color:#147bd1;padding:5px 5px 5px 10px;position:fixed;left:0;top:42px;margin-top:-60px;width:100%;z-index:999999;text-align:center;-webkit-box-sizing:initial;box-sizing:initial}#fond-bar-container{display:inline-block;width:98%;margin:0;position:relative;line-height:32px;max-height:32px}#fond-text{position:relative;color:#fff!important;font-size:16px!important;text-align:centecenter!important;margin:0!important;float:left!important;text-shadow:none!important;padding:4px!important;line-height:60px;vertical-align:middle;width:100%}#fond-text,#link-to-fond{font-family:walsheim,Arial!important}#link-to-fond{color:#fff;font-size:14px!important;font-weight:400!important;border:1px solid #fff;padding:6px 20px;border-radius:2px;text-decoration:none!important;margin-left:12px}#fond-small{width:24px;height:24px;margin-right:8px;margin-top:-2px;vertical-align:middle;display:inline!important}#close-fond-bar{position:absolute;top:26px;right:5px;width:14px;z-index:999999;font-family:Arial;font-size:12px}</style></head>

<body class="" data-new-gr-c-s-check-loaded="14.1088.0" data-gr-ext-installed="">

<!-- Explanation Box is a floating div that explains what to do on a given page, for external or new users -->
<div id="explanationBox" style="display: none;">
	<div id="explanationInnerBox">
		<div style="display: flex; justify-content: space-between;">
			<div><h3>Guide Me</h3></div>
			<div style="text-align: right;"><a class="fa fa-window-close" onclick="hideExplanationBox(event); setAutoExplanationHide();"></a></div>
			</div>
		<div style="max-height: 400px; overflow-y: auto;">

			
			<!-- autoescape off allows for HTML to be embedded directly from a model -->
			<p>This view is generated via the Tableau Server REST API. 

</p><p>The data and images are returned and then rendered by the web application into this view.

</p><p>It retrieves all of the content this particular user can see - so the view adjusts automatically based on the user's Group membership and Permissions in Tableau Server.

</p><p>Often embedded customers start with a hard-coded list of available Tableau reports, then move to this dynamic view, especially if they allow Web Edit by the end customers or do custom report building.
			
		</p></div>
		<!-- !!! !!! VISIBLE TEXT SHOULD BE IN A MODEL !!! !!! -->
		<p><input type="checkbox" name="hide-explanation" id="hideExplanation"><label for="hideExplanation">Stop Hints from Opening Automatically?</label>
	</p></div>
</div>



<!-- Anything before the overall page style wrapper -->



<!-- Top bar is composed of multiple sections. One segment is locked to the left, one to the right -->

<!-- Overall flex div wrapping the whole header toolbar -->
<div id="toolbar-flex-wrapper">

	<!-- Left side buttons container, stay fixed to left side of screen -->
	<div id="logo-div" style="padding: 0px 5px 0px 5px;">
	

		<h2><a href="/en/retail/workspace" class="no-hover"><span class="logo-box">BT</span></a></h2>
	
	</div>

	<div id="title-div">
	
		<h2 style="font-size: 1.5em;"><a href="/en/retail/workspace" class="no-hover">BizThings Supplier Portal</a> </h2>
	
	</div>

	<!-- After the first left side block is the title of any given page (overwritten in some pages) -->
	<div id="page-title-div">
	
		<h2><span> Interactive Analytics</span></h2>
	
	</div>

	<!-- End of Left Side container -->

	<!-- Right Side Buttons Container, which stay fixed to right side of screen -->
	<div id="rightEdgeContainer" style="margin-left: auto; display: flex; justify-content: flex-end;">

	
	<!-- Explanation Box opens when you click the i -->
		<div id="showMenuDiv" style="display: none;">
			<h2><a class="icon fa fa-bars" onclick="toggleSidebar(); return null;" style="font-size: 1.8em;"></a></h2>
		</div>
	

	
	<!-- Explanation Box opens when you click the i -->
		<div id="showExplanationDiv">
			<h2><a class="icon fa fa-info-circle" onclick="showExplanationBoxAsOverlay(event);" style="font-size: 1.8em;"></a></h2>
		</div>
	


	
	<!-- Logout button, always furthest element to the right -->
		<!--<div style="margin: 5px 20px 0 20px;">
			<button onclick="invalidateTimeoutCookie(); window.location.href='/en/retail/logout';">Log Out</button>
		</div>-->
	



	
<!-- Pages all show a user thumbnail image to make it feel like a "real" system -->
		<div id="userHeadshot">
			<!-- Gotta wrap this in Django if in case it is blank, otherwise the whole page errors out -->
			<span id="user-headshot" onmouseover="keepUserMenuVisible=true; showUserMenu(event);" onmouseout="keepUserMenuVisible = false; setTimeout(function(event) { hideUserMenu(event); }, 2000);"> <img alt="" src="/media/images/users/w-2.jpg"> </span>
		</div>

	<!-- End of the right side div container -->
	</div>

	</div>

<!-- Page Wrapper, everything styled by the theme must be within here -->
<div id="page-wrapper">

<!-- Modal Menu in the center of the screen. Used for the login box and nothing more at current time -->





<!-- Wrapper -->
<section id="wrapper">
	
	<div class="wrapper">
	
		<!-- Visible Sidebar -->
		

		<div id="sidebar-visible" class="sidebar-fullscreen-visible" style="padding-top: 60px;">
			
			<h3 style="padding-left: 1em; padding-top: 2em;"><a onclick="toggleNavMenu(); return false;">Navigation <span id="nav-caret" class="fa fa-caret-right"></span></a> </h3>
			<div id="go_to_sidebar">
				<div id="sidebar-links" onmouseover="hideSelectedNav(this);" onmouseout="reapplySelectedNav(this);" style="display: none;">
				

					<ul class="links">
						<li><a href="/en/retail/workspace" id="workspace-button">My Workspace</a></li>
						<li><a href="/en/retail/news" id="news-button">Blog</a></li>
						<li><a href="#">Manage My Products</a></li>
						<li><a href="/en/retail/reporting" id="reporting-button">Operational Reports</a></li>
						<li><a href="/en/retail/analytics" id="guided-analytics-button" class="selected-nav">Interactive Analytics</a></li>
						<li><a href="/en/retail/self-service" id="ask-data-button">Self-Service Analytics</a></li>

					 </ul>
				
				</div>
			</div>

			
    <div>
        <h3 style="padding-left: 1em; padding-right: 1em;">Search &amp; Filter</h3>
        <p style="padding-left: 1em; padding-right: 1em;"><input type="text" style="width: 14em;" class="js-shuffle-search"></p>
        <p style="padding-left: 1em; padding-right: 1em;"><button href="#" class="button fit small icon fa fa-repeat fa-2x." onclick="filterAll(); return false;"> Clear Filters</button></p>

        <p></p>

        <h4 style="padding-left: 1em; padding-right: 1em;">Categories</h4>
        <div id="projectFiltersDiv">
            <ul id="projects-list" class="links">

            <li><a href="#" onclick="filterProject(&quot;Analytics&quot;); return false;">Analytics</a></li><li><a href="#" onclick="filterProject(&quot;Operational Reports&quot;); return false;">Operational Reports</a></li></ul>
        </div>

        <!-- Decided on a simple 3-way radio switch for Content Types -->
        <h4 style="padding-left: 1em; padding-right: 1em;" id="contentTypes">Content Types</h4>
          <div class="switch-toggle_switch-candy" style="padding-left: 1em; padding-right: 1em;">
            <input id="contentTypesAll" name="view" type="radio" checked="">
            <label for="contentTypesAll" onclick="filterAll();">All</label>
            <br>
            <input id="contentTypesDashboards" name="view" type="radio">
            <label for="contentTypesDashboards" onclick="filterDashboard();">Dashboards</label>
            <br>
            <input id="contentTypesSheets" name="view" type="radio">
            <label for="contentTypesSheets" onclick="filterView();">Sheets</label>
            <a></a>
          </div>

    </div>


			<!-- Only set the sidebar item if the sidebar is even in a page -->
			<script>
				
var menuItemName = 'guided-analytics-button';

				// Set the menu item name for highlighting. Comes from dark_theme_ui.js
				setMenuItemForCurrentPage(menuItemName);
			</script>
			
		</div>
	<!-- This closes the wrapper DIV, which makes the inner content of the content pane work correctly for the shuffle elements -->
	</div>
		

		
<!-- Stays minimized until shown by the hover-over -->
<div id="userMenuDiv" onmouseover="keepUserMenuVisible=true;" onmouseout="keepUserMenuVisible = false; setTimeout(function(event) { hideUserMenu(event);}, 1000);" style="z-index: 10000; padding: 0px;">
	<ul style="list-style: none; margin: 0;" class="links">
		<!--<li>n184572</li>-->
		<li><a onclick="invalidateTimeoutCookie(); window.location.href='/en/retail/logout';return null">Log Out</a></li>
	</ul>
</div>

<div class="inner" id="outer-main-div" style="margin: 0 auto 0 auto; width: 100%; height: 100%; display: flex;  justify-content: flex-start; padding-top: 65px; padding-left: 16em;">
	<div id="main-content-div" style="display: flex; width: 100%; padding: 0em 2em 0em 1em; ">
		<div class="workspace" style="justify-content: space-around; width: 100%; padding: 0 0 0 0;">


			
    <!-- Entirely filled out by the shuffle.js code below -->
    <div class="inner" id="tableau_workbook_hierarchy">
    <div class="my-shuffle-container shuffle" id="shuffleGridContainer" style="position: relative; overflow: hidden; height: 1243.2px; transition: height 250ms cubic-bezier(0.4, 0, 0.2, 1) 0s;"><figure class="shuffle-item viz-listing col-4-listing shuffle-item--visible" data-title="Top Accounts" data-groups="[&quot;Analytics&quot;,&quot;Accounts Review&quot;,&quot;Top Accounts&quot;,&quot;dashboard&quot;]" style="position: absolute; top: 0px; left: 0px; visibility: visible; will-change: transform; opacity: 1; transition-duration: 250ms; transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1); transition-property: transform, opacity;"><div><span class="image fit"><a href="workbook/AccountsReview/initialview/TopAccounts"><img src="/tabrestrest/retail/workbooks/017c02a8-978e-4968-84f9-0e432255b57e/views/f77553f4-e536-4a3d-b269-2070fbbc66ab/view-image/" height="250" width="250"></a></span></div><figcaption><h2 style="margin-bottom: 0em !important;"><a href="workbook/AccountsReview/initialview/TopAccounts" style="font-weight: normal;">Top Accounts</a></h2><h3>Accounts Review</h3></figcaption></figure><figure class="shuffle-item viz-listing col-4-listing shuffle-item--visible" data-title="Customer Breakdown" data-groups="[&quot;Analytics&quot;,&quot;Custom Consulting&quot;,&quot;Customer Breakdown&quot;,&quot;dashboard&quot;]" style="position: absolute; top: 0px; left: 0px; visibility: visible; will-change: transform; opacity: 1; transform: translate(339px, 0px) scale(1); transition-duration: 250ms; transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1); transition-property: transform, opacity;"><div><span class="image fit"><a href="workbook/CustomConsulting/initialview/CustomerBreakdown"><img src="/tabrestrest/retail/workbooks/063b47a6-7b82-4f01-9152-ed67f79ff430/views/f6f4bddc-c712-4421-977b-e2a805735c62/view-image/" height="250" width="250"></a></span></div><figcaption><h2 style="margin-bottom: 0em !important;"><a href="workbook/CustomConsulting/initialview/CustomerBreakdown" style="font-weight: normal;">Customer Breakdown</a></h2><h3>Custom Consulting</h3></figcaption></figure><figure class="shuffle-item viz-listing col-4-listing shuffle-item--visible" data-title="Executive Dashboard" data-groups="[&quot;Analytics&quot;,&quot;Custom Consulting&quot;,&quot;Executive Dashboard&quot;,&quot;dashboard&quot;]" style="position: absolute; top: 0px; left: 0px; visibility: visible; will-change: transform; opacity: 1; transform: translate(0px, 414px) scale(1); transition-duration: 250ms; transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1); transition-property: transform, opacity;"><div><span class="image fit"><a href="workbook/CustomConsulting/initialview/ExecutiveDashboard"><img src="/tabrestrest/retail/workbooks/063b47a6-7b82-4f01-9152-ed67f79ff430/views/2fbafb31-de04-477b-875d-c9468784a91a/view-image/" height="250" width="250"></a></span></div><figcaption><h2 style="margin-bottom: 0em !important;"><a href="workbook/CustomConsulting/initialview/ExecutiveDashboard" style="font-weight: normal;">Executive Dashboard</a></h2><h3>Custom Consulting</h3></figcaption></figure><figure class="shuffle-item viz-listing col-4-listing shuffle-item--visible" data-title="Orders Breakdown" data-groups="[&quot;Analytics&quot;,&quot;Custom Consulting&quot;,&quot;Orders Breakdown&quot;,&quot;dashboard&quot;]" style="position: absolute; top: 0px; left: 0px; visibility: visible; will-change: transform; opacity: 1; transform: translate(339px, 414px) scale(1); transition-duration: 250ms; transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1); transition-property: transform, opacity;"><div><span class="image fit"><a href="workbook/CustomConsulting/initialview/OrdersBreakdown"><img src="/tabrestrest/retail/workbooks/063b47a6-7b82-4f01-9152-ed67f79ff430/views/28811df2-81ec-45e1-acbd-df9023021502/view-image/" height="250" width="250"></a></span></div><figcaption><h2 style="margin-bottom: 0em !important;"><a href="workbook/CustomConsulting/initialview/OrdersBreakdown" style="font-weight: normal;">Orders Breakdown</a></h2><h3>Custom Consulting</h3></figcaption></figure><figure class="shuffle-item viz-listing col-4-listing shuffle-item--visible" data-title="Retail Dashboard" data-groups="[&quot;Analytics&quot;,&quot;Performance Dashboard&quot;,&quot;Retail Dashboard&quot;,&quot;dashboard&quot;]" style="position: absolute; top: 0px; left: 0px; visibility: visible; will-change: transform; opacity: 1; transform: translate(0px, 829px) scale(1); transition-duration: 250ms; transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1); transition-property: transform, opacity;"><div><span class="image fit"><a href="workbook/PerformanceDashboard/initialview/RetailDashboard"><img src="/tabrestrest/retail/workbooks/e8fae8d9-a411-467e-8274-c1a99d9516d7/views/21b9fa9e-e494-4b62-9873-51d99906f0dd/view-image/" height="250" width="250"></a></span></div><figcaption><h2 style="margin-bottom: 0em !important;"><a href="workbook/PerformanceDashboard/initialview/RetailDashboard" style="font-weight: normal;">Retail Dashboard</a></h2><h3>Performance Dashboard</h3></figcaption></figure><figure class="shuffle-item viz-listing col-4-listing shuffle-item--visible" data-title="Transactions" data-groups="[&quot;Operational Reports&quot;,&quot;Retail Transactions&quot;,&quot;Transactions&quot;,&quot;view&quot;]" style="position: absolute; top: 0px; left: 0px; visibility: visible; will-change: transform; opacity: 1; transform: translate(339px, 829px) scale(1); transition-duration: 250ms; transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1); transition-property: transform, opacity;"><div><span class="image fit"><a href="workbook/RetailTransactions/initialview/Transactions"><img src="/tabrestrest/retail/workbooks/01543c9d-63cc-4647-bb3f-8edfafc0998b/views/bd326d42-7577-49db-88ca-78cb803713b9/view-image/" height="250" width="250"></a></span></div><figcaption><h2 style="margin-bottom: 0em !important;"><a href="workbook/RetailTransactions/initialview/Transactions" style="font-weight: normal;">Transactions</a></h2><h3>Retail Transactions</h3></figcaption></figure><div class="my-sizer-element"></div></div></div>


		
				</div>
			</div>
		</div>
		
	</section></div>




<!-- Footer. May only be used on the index / landing page for each vertical at this point -->
<section>
</section>


<!-- Close the the page-wrapper div -->
<!-- This effectively ends the HTML of the page itself -->


<!-- Scripts that load AFTER the HTML content -->
<script src="/staticfiles/solidstate/assets/js/jquery.min.js"></script>
<script src="/staticfiles/js/jquery-ui.js"></script>
<script src="/staticfiles/solidstate/assets/js/jquery.scrollex.min.js"></script>
<script src="/staticfiles/solidstate/assets/js/browser.min.js"></script>
<script src="/staticfiles/solidstate/assets/js/breakpoints.min.js"></script>
<script src="/staticfiles/solidstate/assets/js/util.js"></script>
<script src="/staticfiles/solidstate/assets/js/main.js"></script><nav id="menu">
	<div class="inner" style="width: unset;">
		
		
	</div>
</nav>



<!-- Tableau JS API Code (and any other header code) specific to a given page -->
<!-- TabFilters class has to be called before reference in embedded_system.js so I added the link to src here in base template-->
<script type="text/javascript" src="https://ts2.embedded.tableau.com/javascripts/api/tableau-2.min.js"></script><script src="https://ts2.embedded.tableau.com/javascripts/api/tableau-2.9.1.min.js"></script>
<script type="text/javascript" src="/staticfiles/js/responsive_scaling_tableau.js"></script>
<script type="text/javascript" src="/staticfiles/js/tabfilters.js"></script>
<script type="text/javascript" src="/staticfiles/js/embedded_system.js"></script>

<!-- 3rd party css -->
<link rel="stylesheet" href="/staticfiles/solidstate/assets/css/select2.css">
<!--<link rel="stylesheet" href="/staticfiles/solidstate/assets/css/bootstrap.min.css" />-->



<script>
function toggleSidebar() {
	let sidebarDiv = document.getElementById('sidebar-visible');

	// There's no value by default at all when queried
	if (sidebarDiv.style.display == ""){
		// Must check to see if the media query for small sizes is in plac
		let mqList = window.matchMedia('screen and (max-width: 1080px)');
		console.log(mqList);
		if (mqList.matches == true) {
			sidebarDiv.style.display = "block";
		}
		else {
			sidebarDiv.style.display = "none";
		}
	}
	else if (sidebarDiv.style.display != "none"){
		sidebarDiv.style.display = "none";
	}
	else if (sidebarDiv.style.display == "none"){
		sidebarDiv.style.display = "block";
	}
}
</script>




    <script src="/staticfiles/js/shuffle.min.js"></script>
    <script>
        showExplanationBoxOnLoad();
        // Toggle the nav menu closed because there are lots of filters in the sidebar that need real estate
        toggleNavMenu();

        console.log('Here extra script starts');
        var projectNameTranslations = {"en_Analytics": "Analytics", "en_Executive Analytics": "Executive Analytics", "en_Operational Reports": "Operational Reports", "en_My Content": "My Content", "en_News": "News", "en_Widgets": "Widgets", "en_Self-Service Data Sources": "Self-Service Data Sources", "en_Data Sources": "Data Sources"};

        var hierarchyDestDivId = "tableau_workbook_hierarchy";
        var filterDestID = "projects-list";

        var fullRestUrl = buildRestUrl('full-hierarchy-views', 'retail');
        var shuffleInstance;

        /*
        *  Builds up each element to be put into the trellis / shuffled hierarchy
        */
        function writeWorkbookHierarchyDisplay(data, destinationDivId, vertical, projectNameTranslations){

            let tmp_metadata_shuffle_array = [];

            var fullHierarchy = data;
            var destDiv = document.getElementById(destinationDivId);
            var rowDiv = document.createElement('div');
            rowDiv.className = "my-shuffle-container";
            rowDiv.id = 'shuffleGridContainer';
            //ul.className = 'alt';

            // For this one, we're going to build figures and figcaptions instead of an unordered list
            // Each View will be represented separately -- View-centric, with Project and Workbook as attributes

            for (project in fullHierarchy){
                // Replace with any existing translation
                var projectFinalName = project;
                if (project in projectNameTranslations) {
                    projectFinalName = projectNameTranslations[project];
                }
               // var li = document.createElement('li');
                //li.innerText = project;
                for (workbook in fullHierarchy[project]){
                    //var li2 = document.createElement('li');
                    //li2.innerText = workbook;
                    for (view in fullHierarchy[project][workbook]){

                        let sheetType = fullHierarchy[project][workbook][view].sheetType;
                        var contentUrl = fullHierarchy[project][workbook][view].contentUrl;
                        var finalContentUrl = contentUrl.replace('sheets', 'initialview');
                        finalContentUrl = 'workbook/' + finalContentUrl;

                        var f = document.createElement('figure');
                        f.className = 'shuffle-item viz-listing col-4-listing';
                        var d = document.createElement('div');
                        var span = document.createElement('span');
                        span.className = 'image fit';

                        var a_img = document.createElement('a');
                        a_img.href = finalContentUrl;

                        span.append(a_img);
                        var img = document.createElement('img');
                        // This is a very simple start to dynamic images
                        img.src = "/tabrestrest/" + vertical + "/workbooks/" + fullHierarchy[project][workbook][view].workbook.id + "/views/" + fullHierarchy[project][workbook][view].id + '/view-image/';

                        // We should probably resize the thumbnails to the size we want and let them naturally be that size
                        img.height = 250;
                        img.width = 250;
                        a_img.append(img)
                        d.append(span);
                        f.append(d);

                        var fc = document.createElement('figcaption');
                        var h2 = document.createElement('h2');
                        var a = document.createElement('a');

                        a.href = finalContentUrl;
                        h2.style = "margin-bottom: 0em !important;";
                        a.innerText = removeTransliterations(fullHierarchy[project][workbook][view].name);
                        a.style = "font-weight: normal; !important;"

                        h2.append(a)
                        fc.append(h2);
                        //
                        var wbP = document.createElement('h3');
                        wbP.innerText =  removeTransliterations(workbook);
                        fc.append(wbP);
                        //
                        //var projP = document.createElement('h4');
                        //projP.innerText =  project;
                        //fc.append(projP);
                        //
                        // var stP = document.createElement('h5');
                        // stP.innerText = "type: " + sheetType;
                        // fc.append(stP);

                        // Add the attributes of data-groups and data-title to the figure element for Shuffle.js
                        f.setAttribute('data-title', fullHierarchy[project][workbook][view].name);

                        // f.setAttribute('data-groups', "[\"" + project + "\"]" );

                        tmp_metadata_shuffle_array = [projectFinalName, workbook, view, sheetType];
                        f.setAttribute('data-groups', JSON.stringify(tmp_metadata_shuffle_array));

                        f.append(fc);
                        rowDiv.append(f);
                    }
                    //li.append(li2);
                }
                //ul.append(li);
            }
            var sizerDiv = document.createElement('div');
            sizerDiv.className = 'my-sizer-element';
            rowDiv.append(sizerDiv);
            destDiv.append(rowDiv);
        }

        $.getJSON(fullRestUrl,
            function (data, status, xhr){
                writeWorkbookHierarchyDisplay(data, hierarchyDestDivId, "retail", projectNameTranslations);
                writeProjectFilters(data, filterDestID, projectNameTranslations);
                console.log("data:", data);
            }
        ).done(
                function () {
                    console.log('It worked!');


                    // Start of Shuffle.js implementation
                  shuffleInstance = new Shuffle(document.getElementById('shuffleGridContainer'), {
                      itemSelector: '.shuffle-item'
                      //,sizer: '.my-sizer-element'
                    });
                    initializeFilterBox();

                    // // Overrideable options
                    // shuffleInstance.options = {
                    //   buffer: 0, // Useful for percentage based heights when they might not always be exactly the same (in pixels).
                    //   columnThreshold: 0.01, // Reading the width of elements isn't precise enough and can cause columns to jump between values.
                    //   columnWidth: 0, // A static number or function that returns a number which tells the plugin how wide the columns are (in pixels).
                    //   delimiter: null, // If your group is not json, and is comma delimeted, you could set delimiter to ','.
                    //   easing: 'cubic-bezier(0.4, 0.0, 0.2, 1)', // CSS easing function to use.
                    //   filterMode: Shuffle.FilterMode.ANY, // When using an array with filter(), the element passes the test if any of its groups are in the array. With "all", the element only passes if all groups are in the array.
                    //   group: Shuffle.ALL_ITEMS, // Initial filter group.
                    //   gutterWidth: 0, // A static number or function that tells the plugin how wide the gutters between columns are (in pixels).
                    //   initialSort: null, // Shuffle can be initialized with a sort object. It is the same object given to the sort method.
                    //   isCentered: false, // Attempt to center grid items in each row.
                    //   itemSelector: '*', // e.g. '.picture-item'.
                    //   roundTransforms: true, // Whether to round pixel values used in translate(x, y). This usually avoids blurriness.
                    //   sizer: null, // Element or selector string. Use an element to determine the size of columns and gutters.
                    //   speed: 0, // Transition/animation speed (milliseconds).
                    //   staggerAmount: 15, // Transition delay offset for each item in milliseconds.
                    //   staggerAmountMax: 150, // Maximum stagger delay in milliseconds.
                    //   throttle: throttle, // By default, shuffle will throttle resize events. This can be changed or removed.
                    //   throttleTime: 300, // How often shuffle can be called on resize (in milliseconds).
                    //   useTransforms: true, // Whether to use transforms or absolute positioning.
                    // };

                }
            )
            .fail(
                    function( jqxhr, textStatus, error ) {
                        var err = textStatus + ", " + error;
                        console.log( "Request Failed: " + err );
                    }
            );


        /*
        * Everything below is the filtering code for working with shuffle.js
        */
        // function removeFilters(){
        //     shuffleInstance.filter(Shuffle.ALL_ITEMS);
        // }
        //
        // function filterDefault(){
        //     console.log("Should be filtering");
        //     console.log(shuffleInstance);
        //     shuffleInstance.filter('Project 2');
        // }

        function writeProjectFilters(data, filterDestID, projectNameTranslations){

            var fullHierarchy = data;
            var destDiv = document.getElementById(filterDestID);
            //ul.className = 'alt';

            // For this one, we're going to build figures and figcaptions instead of an unordered list
            // Each View will be represented separately -- View-centric, with Project and Workbook as attributes

            for (project in fullHierarchy){
                    // Replace with any existing translation
                    var projectFinalName = project;
                    if (project in projectNameTranslations) {
                        projectFinalName = projectNameTranslations[project];
                    }
                    //console.log(project);
                    // Don't list if there is nothing in it
                    if ( Object.keys(fullHierarchy[project]).length === 0) {}
                    else {
                        let li = document.createElement('li');
                        li.innerHTML = "<a href='#' onclick='filterProject(\"" + projectFinalName + "\"); return false;'>" + projectFinalName + "</a>";
                        destDiv.append(li);
                    }
            }
        }

        function filterProject(projectName){
            shuffleInstance.filter(projectName);
        }

        function filterProjectDefault(){
            shuffleInstance.filter('Default');
        }

        function filterProjectProject2(){
            shuffleInstance.filter('Project 2');
        }

        function filterDashboard(){
            shuffleInstance.filter('dashboard');
        }

        function filterView(){
            shuffleInstance.filter('view');
        }

        function filterAll(){
            shuffleInstance.filter(Shuffle.ALL_ITEMS);
            document.querySelector('.js-shuffle-search').value = "";
        }

        // Filter the shuffle instance by items with a title that matches the search input.
        function _handleSearchKeyup (evt) {
          var searchText = evt.target.value.toLowerCase();

          shuffleInstance.filter(function (element, shuffle) {
            var title = element.getAttribute('data-title');
            //var titleElement = element.querySelector('.shuffle-item__title');
            var titleText = title.toLowerCase().trim();

            return titleText.indexOf(searchText) !== -1;
          });
        };

        function initializeFilterBox() {
        // Advanced filtering (filter box, taken from Shuffle.js website example)

          document.querySelector('.js-shuffle-search').addEventListener('keyup', _handleSearchKeyup.bind(this));

        }
        /*
        * End shuffle.js filter code
        */
</script>


	

</body><grammarly-desktop-integration data-grammarly-shadow-root="true"></grammarly-desktop-integration></html>
